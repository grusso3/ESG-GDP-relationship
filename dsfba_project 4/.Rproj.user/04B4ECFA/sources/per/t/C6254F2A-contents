
# 4- Analysis

```{r, echo = FALSE, message = FALSE, warning=FALSE,cache=TRUE}
source(here::here("scripts/setup.R"))
```

For our analysis , we will attempt to:

- **Analyze using a Representative Sample Group**
- **Conduct Quantitative Statistical Analysis**
- **Conduct different Visual Analysis**
- **Answer the research questions**


```{r, echo=FALSE}
Complete.Table <- read.csv(here::here("data/Complete.Table"))
Rebased.Table <- read.csv(here::here("data/Rebased.Table"))
G9.Table <- read.csv(here::here("data/G9.Table"))
Data.98.08.18 <- read.csv(here::here("data/Data.98.08.18"))
Rebased.Pivot <- read.csv(here::here("data/Rebased.Pivot"))

```

## A- Sample Country Selection

We have 80+ countries after importing and wrangling/cleaning our data, the data set is too big to analyse each country by itself and too time consuming.

Our first approach will be to choose sample countries representing the following criteria:

- One for each Income Group
- One for Each Region
- Filtering will be based on the biggest GDP per capita (in 2019) for each cross-category

We will end with less than 28 countries and we will base our analysis on them.


### Representative Countries

We filtered our data to get the results based on the above criteria and we got the following table 
<div style="margin-bottom:50px;">

```{r fig.show= "hide", echo=FALSE}
Complete.Table %>%
filter(Year == 2019) %>%
select(Income.Group:Country, GDPpcap) %>%
arrange(desc(GDPpcap)) %>%
group_by(Income.Group, Region) %>%
top_n(1) %>%
kbl( booktabs = TRUE) %>%
  kable_classic(full_width = T, html_font = "Cambria", "striped")%>%
  kable_styling(bootstrap_options = c("hover", "condensed")) %>% 
  scroll_box(width = "100%", height = "450px")
```
</div>
For the sake of having a more sound and globally inclusive analysis we will need to include the UK and China to the above list of countries and conduct our visual analysis on 20 countries representing different income groups of different regions with relatively big GDP per capita.

We also made some modifications for country significance, and lower political distortion, in the past few years and changed the following:

- South Asia: India instead of Sri Lanka
- Latin America: Brazil instead of Costa Rica
- Middle East: Saudi Arabia instead of Israel
- Sub-Saharan Africa: South Africa instead of Botswana
- Sub-Saharan Africa: Ghana instead of Eswatini

We want to check whether Economic growth over the past 30 years has been associated with Social Improvement, Government Improvement and efficiency  and Environmental well-being. Moreover, we will also check whether ESG indexes have been associated with traditional social developments such age Female Labor , Urbanization and Young population.

**The Representative Countries**

The resulting Representative countries we will use for our analysis are the following

<div style="margin-bottom:50px;">
```{r, echo=FALSE}

Complete.Table%>%
  filter( Country == "China" | Country == "United States" |Country == "Russia" | Country == "Haiti" | Country == "Australia" | Country == "Switzerland" | Country == "United Kingdom" |Country == "Saudi Arabia" | Country == "Malaysia" |Country == "Mongolia" |Country == "India" |Country == "Tunisia" |Country == "Guinea" | Country == "Ghana" | Country == "South Africa" |  Country == "Brazil" | Country == "Jordan" | Country == "El Salvador" | Country == "Barbados" | Country == "Ukraine" ) %>%
filter(Year == 2019) %>%
select(Income.Group:Country, GDPpcap) %>%
arrange(desc(GDPpcap)) %>%
group_by(Income.Group, Region) %>%
top_n(1) %>%
kbl( booktabs = TRUE) %>%
  kable_classic(full_width = T, html_font = "Cambria", "striped")%>%
  kable_styling(bootstrap_options = c("hover", "condensed")) %>% 
  scroll_box(width = "100%", height = "450px")  
```
</div>

We also recreated the Representative Countries Complete Tables and the Rebased table to conduct our quantitative and visual analysis. 

<div style="margin-bottom:50px;">
```{r fig.show="hide", echo=FALSE}

Rep.Countries <- Complete.Table %>%
  filter( Country == "China" | Country == "United States" |Country == "Russia" | Country == "Haiti" | Country == "Australia" | Country == "Switzerland" | Country == "United Kingdom" |Country == "Saudi Arabia" | Country == "Malaysia" |Country == "Mongolia" |Country == "India" |Country == "Tunisia" |Country == "Guinea" | Country == "Ghana" | Country == "South Africa" |  Country == "Brazil" | Country == "Jordan" | Country == "El Salvador" | Country == "Barbados" | Country == "Ukraine" ) %>%
  select(-c(FDIusd, FDIGDP))
  
Rep.Rebased <- Rebased.Table %>%
  filter( Country == "China" | Country == "United States" |Country == "Russia" | Country == "Haiti" | Country == "Australia" | Country == "Switzerland" | Country == "United Kingdom" |Country == "Saudi Arabia" | Country == "Malaysia" |Country == "Mongolia" |Country == "India" |Country == "Tunisia" |Country == "Guinea" | Country == "Ghana" | Country == "South Africa" |  Country == "Brazil" | Country == "Jordan" | Country == "El Salvador" | Country == "Barbados" | Country == "Ukraine" ) %>%
  select(-c(FDIusdr, FDIGDPr))

```
</div>

Noting that we have 30 years per 20 countries for 13 indicators, here is the summary analysis of our new representative countries data set:

```{r fig.show="hide", echo=FALSE}
summary(Rep.Countries)
```

The summary analysis of our selection seems satisfying for plotting as the only missing values now are due to 1990-1995 EPI and EFI non existent data as well as 2019 non existent HDI, EduI, IncI and LEI.
GDP and other needed data for analysis are all available. 


### Mapping of Representative Countries 

A map showing the country selection with radius the size of GDP per capita and color scales based on income group:

- Red for Low Income
- Yellow for Lower Middle Income
- Light Blue for Upper Middle Income
- Dark Blue for High Income

Each country also displays its main 3 ESG indicators
<div style="margin-bottom:50px;">

```{r, echo=FALSE}
Map.data<- read.csv(here::here("data/LLData.csv"))

names(Map.data)[4]<- "Country"
names(Map.data)[2]<- "lat" 
names(Map.data)[3]<- "lon" 

MapTable <- Rep.Countries %>%
  filter(Year == 2018) %>%
  inner_join(Map.data[,2:4])
getColor <- function(MapTable) {
  sapply(MapTable$Income.Group, function(Income.Group) {
    if(Income.Group == "High income") {
      "darkblue"
    } else if(Income.Group == "Upper middle income") {
      "blue"
    }else if(Income.Group == "Lower middle income") {
      "orange"
       }else {
      "red"
    } })
}
MapTable %>% leaflet(width = "100%", height = 300) %>% addTiles() %>%
  addAwesomeMarkers(lng = MapTable$lon, lat = MapTable$lat, icon=awesomeIcons(
    icon = 'ios-close',
    iconColor = 'black',
    markerColor = getColor(MapTable)), label=~as.character(Country),
                    popup = paste("Income Group:", MapTable$Income.Group, "<br>",
                                  "Country:", MapTable$Country, "<br>",
                                  "GDPpcap:", as.integer(MapTable$GDPpcap), "<br>",
                                  "EFI:", as.integer(MapTable$EFI), "<br>",
                                  "HDI:", as.integer(MapTable$HDI), "<br>",
                                  "EPI:", as.integer(MapTable$EPI)),
                   
                    labelOptions = labelOptions(noHide = T, direction = "bottom",
                                                style = list(
                                                  "color" = "red",
                                                  "font-family" = "serif",
                                                  "font-style" = "italic",
                                                  "box-shadow" = "2px 2px rgba(0,0,0,0.25)",
                                                  "font-size" = "10px",
                                                  "border-color" = "rgba(0,0,0,0.5)"
                                                )))%>%
  addCircleMarkers(lng=MapTable$lon, lat=MapTable$lat,
                   radius = MapTable$GDPpcap*0.001)
```
</div>

## B- The Quantitative Analysis

### Regression of ESG Indexes Vs GDP 

A sample of 7 countries will be selected from each Region, and with different income groups, to conduct the study.

We picked sample countries from each Region using highest GDP per cap, we got the following table:
<div style="margin-bottom:50px;">

```{r fig.show= "hide", echo=FALSE}
Rep.Countries %>%
  filter(Year == 2019) %>%
  select(Income.Group:Country, GDPpcap) %>%
  arrange(desc(GDPpcap)) %>%
  group_by(Region) %>%
  top_n(1)
```
</div>

We will substitute Australia with China, Saudi Arabia with Tunisia and Barbados with Haiti.

The resulting final table will be diverse in Income and Region categories

**Representative Sample**
<div style="margin-bottom:50px;">

```{r, echo=FALSE}
Rep.Countries %>%
  filter(Year == 2019, Country == "Switzerland"|Country == "United States"|Country == "China"|Country == "Tunisia"|Country == "Haiti"|Country == "South Africa"|Country == "India") %>%
  select(Income.Group:Country) 
```
</div>


We will be conduction a multiple linear regression with an independant Y variable as GDP per Capita against the following Dependant X variables:

- EFI: Economic Freedom
- EPI: Environment
- LEI: Life Expectancy
- IncI: Income 
- EduI: Education


The method will be a **Stepwise Regression**:
*A Regressions method used to calibrate automatically by dropping/adding Independent variables to check which X variable is most significantly affecting our Y variable**

Under this method we will judge the X vriables using the "AIC" AKAIKE Information Criterion to pick the ones with lowest AIC which are mostly significant in our study.
We will apply this regression on the whole group of our representative sample.

**Competing Methods**:
The choice of this model is that it is a commonly and widely used quantitative analysis method to study what best variables to use as independent to explain one dependent variable. 
Other methods such as the Bayesian and Cp Mallows could be used but the AIC allows us to get a summary table with the resulting Dropped and kept coefficients of each variables for multiple countries chosen. 
It also allows us to plot those coefficient of different variables for different countries as we will see below.

**Stepwise Regression for the sample countries**
<div style="margin-bottom:50px;">

```{r ,warning = FALSE, echo=FALSE}
Reg.AIC.GDP <- list(step(lm(
  GDPpcap ~ EFI + EPI + LEI + IncI + EduI,
  data = filter(Rep.Countries, Country == "Switzerland", Year != c("1990","1991","1992","1993","1994","2019"))))
, step(lm(
  GDPpcap ~ EFI + EPI + LEI + IncI + EduI,
  data = filter(Rep.Countries, Country == "United States", Year != c("1990","1991","1992","1993","1994","2019"))))
,step(lm(
  GDPpcap ~ EFI + EPI + LEI + IncI + EduI,
  data = filter(Rep.Countries, Country == "South Africa", Year != c("1990","1991","1992","1993","1994","2019"))))
,step(lm(
    GDPpcap ~ EFI + EPI + LEI + IncI + EduI ,
    data = filter(Rep.Countries, Country == "China", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    GDPpcap ~ EFI + EPI + LEI + IncI + EduI,
    data = filter(Rep.Countries, Country == "India", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    GDPpcap ~ EFI + EPI + LEI + IncI + EduI ,
    data = filter(Rep.Countries, Country == "Tunisia", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    GDPpcap ~ EFI + EPI + LEI + IncI + EduI,
    data = filter(Rep.Countries, Country == "Haiti", Year != c("1990","1991","1992","1993","1994","2019")))))

print(export_summs(Reg.AIC.GDP))
```
</div>

*Analysis: We can see significant relationships between GDP per Capita and EPI, LEI, IncI and to a lesser extent EduI. On the other hand, we can notice that EFI is only majorly associated to GDP in China*


A more visual approach that plots each coefficient of every indicator for every country studied in a plot

**Plot of coefficients for the sample countries**
```{r, warning=FALSE ,echo=FALSE}
plot_summs(Reg.AIC.GDP, scale = TRUE, plot.distributions = TRUE, rescale.distributions = TRUE, legend.title = "Country/Inc.Grp" , model.names = c( "Swit HI","USA HI","SAfr UMI","China UMI","India LMI","Tunis LMI","Haiti LI"))+
  ggtitle("Coefficient Plot")
``` 

*Analysis: It is clearly observable that High Income countries' GDP is more or less affected by most variables while the lower the income level the more  GDP becomes linked mainly to Income, Life Expectancy, Enviromental and to a lesser extent Education variables*



### Regression of Traditional Social Indicators Vs ESG Index


To test whether the Scoring Indexes correlate with traditional Social Indicators we will use our ESG Composite and the Y variable against the following X variables:

- Unemployment Rate
- Aging Population
- Female Labour Participation
- Urbanisation


We will use the same Regression method we did before for these new variables

**Stepwise Regression for the sample countries**

```{r , echo=FALSE}
Reg.AIC.ESG <- list(step(lm(
  ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
  data = filter(Rep.Countries, Country == "Switzerland", Year != c("1990","1991","1992","1993","1994","2019"))))
, step(lm(
  ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
  data = filter(Rep.Countries, Country == "United States", Year != c("1990","1991","1992","1993","1994","2019"))))
,step(lm(
  ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
  data = filter(Rep.Countries, Country == "South Africa", Year != c("1990","1991","1992","1993","1994","2019"))))
,step(lm(
    ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
    data = filter(Rep.Countries, Country == "China", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
    data = filter(Rep.Countries, Country == "India", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
    data = filter(Rep.Countries, Country == "Tunisia", Year != c("1990","1991","1992","1993","1994","2019"))))
    ,step(lm(
    ESGcomp ~ Urban+Unemploy+FemLab+AgingPop,
    data = filter(Rep.Countries, Country == "Haiti", Year != c("1990","1991","1992","1993","1994","2019")))))

print(export_summs(Reg.AIC.ESG))
```
*Analysis: We can directly notice that Unemployment and Aging Population have no significant impact on our sample countries's ESG composite (with 1 or 2 exceptions). Urbanisation however seem to positively and strongly correlates with all countries except switzerland (negtive correlation). Female Labour has some opposite relationships between middle income countries*

And now the visual representation...

**Plot of coefficients for the sample countries**
```{r warning = FALSE, echo= FALSE}
plot_summs(Reg.AIC.ESG, plot.distributions = TRUE, rescale.distributions = TRUE, 
legend.title = "Country-Inc.Grp" , model.names = c("Switzerland-HI","USA-HI","South Africa/UMI","China/UMI","India/LMI","Tunisia/LMI","Haiti/LI"))+
  ggtitle("Coefficient Plot")
```   
    
*Analysis: Aging population seems to relate differently to most countries but as the quants suggest, not significantly. Urbanization has a clear effect.The mixed effect of Female Labour is also clear.*


### Principal Component Analysis

We will use Principal Component Analysis to check which variables are mostly related to each other by plotting Indexes and traditional Indicators on PCA graph

The PCA is model that draws an X,Y dimensional scale that rotates in attempt to try and capture the most amount of variation explained by the variables. All plotted variables are represented by a 2 dimensional graph that tries to derive whether a group of them closely relate in terms of explaining variations of the whole dataset. 

PCA is a widely used method for exploratory Data analysis.

**Competing Method**:
Another method that could be used would be factor analysis, but that method attempts to represent a group variables through the creation of a common factor that constitutes a dimension instead of treating every single variable as an independant component; hence our choice of PCA.


**PCA graphs - High Income - USA and Switzerland**

```{r  fig.show= "hide", echo=FALSE} 
PCA.swiss <- (fviz_pca_var(PCA(Rep.Countries%>% filter( Country == "Switzerland", Year != c("1990","1991","1992","1993","1994","2019")) %>%select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))

PCA.usa <- (fviz_pca_var(PCA(Rep.Countries%>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>% select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))
```

```{r, echo=FALSE}
plot_grid(PCA.swiss , PCA.usa, rel_heights = c(2,2), nrow= 1,
           labels = c("Switzerland", "United States"))
  
```

*Analysis: We can clearly rule out the effect of GDP growth from the 2 graphs. We notice the concentration of the Scoring ESG indexes on 1 Dimension* 

**PCA graphs - Upper Middle Income - China and India**

```{r  fig.show= "hide", echo=FALSE}
PCA.china <- (fviz_pca_var(PCA(Rep.Countries%>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>%select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))

PCA.india <- (fviz_pca_var(PCA(Rep.Countries%>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>% select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))
```

```{r, echo=FALSE}
plot_grid(PCA.china , PCA.india, rel_heights = c(2,2), nrow= 1,
           labels = c("China", "India"))
  
```

*Analysis: We can clearly rule out the effect of GDP growth Unemployment and Female Labor from the 2 graphs. We notice the concentration of the Scoring ESG indexes on 1 Dimension but without EPI in this instance* 

**PCA graphs - Lower Middle Income - Tunisia, South Africa**

```{r  fig.show= "hide", echo=FALSE}
PCA.tunis <- (fviz_pca_var(PCA(Rep.Countries%>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>%select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))

PCA.SA <- (fviz_pca_var(PCA(Rep.Countries %>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>% select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))

```

```{r, echo=FALSE}
plot_grid(PCA.tunis , PCA.SA, rel_heights = c(2,2), nrow= 1,
           labels = c("Tunisia", "South Africa"))
  
```

*Analysis: At this stage it is safe to rule out most traditional Social indicators except urbanisation nad we can still assert the high relationship between EduI, IncI, GDp per Cap, HDI, LEI* 

**PCA graphs - Low Income - Haiti**

```{r fig.show= "hide", echo=FALSE}
PCA.haiti <- (fviz_pca_var(PCA(Rep.Countries %>% filter( Country == "United States", Year != c("1990","1991","1992","1993","1994","2019")) %>% select(5:17)), col.var="contrib",
      gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),  repel = TRUE ))
```

```{r, echo=FALSE}
plot_grid(PCA.haiti, rel_heights = 2, nrow= 1,
           labels = c("Haiti"))
  
```

*Analysis: Income Index seems to not relate as much for this Low Income country, the only significant but weaker relationships are between HDI, LEI, EduI and Urban and somewhat GDP* 

## C- Time Series Analysis

### Environment, Social and Governmental Indexes 

Plots Showing the evolution of the Index scores over the past 25 to 30 years for each country

**High Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "EduIr"|Indicator== "EPIr"| Indicator=="LEIr"|  Indicator=="EFIr"|  Indicator=="IncIr", Income.Group == "High income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("ESG Index in High Income countries"), height= 400
)

```

*Analysis: EFI's trend and volatility seems to differ for most countries, Income and Life expectancy always show correlated trends but the line itself is too smooth and mostly linear.*


**Upper Middle Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "EduIr"|Indicator== "EPIr"| Indicator=="LEIr"|  Indicator=="EFIr"|  Indicator=="IncIr", Income.Group == "Upper middle income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("ESG Indexes in Upper middle income Countries"), height= 400
)

```

*Analysis: For Upper middle income countries we observe more volatility in Indexes and a wider spread of growth rates. It is difficult to conclude a clear correlation but we cannot rule it out as well*


**Lower Middle Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "EduIr"|Indicator== "EPIr"| Indicator=="LEIr"|  Indicator=="EFIr"|  Indicator=="IncIr", Income.Group == "Lower middle income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("ESG Indexes in Lower middle income Countries"), height=400
)

```

*Analysis: For the lower middle income, the spread of growth gets wider and the variability increases. It seems as if Economic Freedom and Environmental Performance are less linked to other indicators*

**Low Income Countries**

```{r , echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "EduIr"|Indicator== "EPIr"| Indicator=="LEIr"|  Indicator=="EFIr"|  Indicator=="IncIr", Income.Group == "Low income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("ESG Indexes in Low income Countries"), height = 400
)

```

*Analysis: By now, we start noticing the relationship between Income Group and Index variability and correlation. Low Income countries barely show any correlation*


### Traditional Social Indicators Vs ESG Composite

Plotting Urbanisation, Aging population and Female Labor Participation time series against our own ESG composite.
We will try to test and see whether Traditional Social indicators and our composite Scoring ESG index have a distinct growing relationship over time.

Unemployment Rate will not be used in our analysis as we observed by variations in the rbasing in most countries; moreover this indicator is closely tied to GDP which is already being evaluated in our study.


**High Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "Urbanr"| Indicator=="FemLabr"|  Indicator=="ESGcompr"|  Indicator=="AgingPopr", Income.Group == "High income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("Social Indicators in High Income Countries"), height= 400
)

```

*Analysis: Difficult to observe a distinct relationship as different regions have different trends. It seems Female Labour and Urbanisation correlate with the ESG in some countries*

**Upper Middle Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "Urbanr"| Indicator=="FemLabr"|  Indicator=="ESGcompr"|  Indicator=="AgingPopr", Income.Group == "Upper middle income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("Social Indicators in Upper Middle Income Countries"), height=400
)

```

*Analysis: Aging Population showing absolutely no sign of relationship. Less observed linked for the ESG with Female Labor and Urbanisation*


**Lower Middle Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "Urbanr"| Indicator=="FemLabr"|  Indicator=="ESGcompr"|  Indicator=="AgingPopr", Income.Group == "Lower middle income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("Social Indicators in Lower Middle Income Countries"), height=400
)

```

*Analysis: More or less same patterns and conclusions with Upper middle income countries*


**Low Income Countries**

```{r, echo=FALSE}
ggplotly(ggplot((Rep.Rebased %>% 
    pivot_longer(c(Urbanr:ESGcompr), names_to = "Indicator",values_to = "Value") %>%
filter( Indicator== "Urbanr"| Indicator=="FemLabr"|  Indicator=="ESGcompr"|  Indicator=="AgingPopr", Income.Group == "Low income")),
   (aes(x= Year, y= Value)))+ 
  geom_line(aes(color= Indicator))+
  scale_color_manual(values = c("darkred", "steelblue","deeppink","grey45", "yellow","green"))+
  theme_gray(base_size = 14, base_family = "Times")+
  facet_wrap_paginate(
    ~Country,
    nrow = 2,
    ncol = 2,
    scales = "fixed",
    shrink = TRUE,
    labeller = "label_value",
    as.table = TRUE,
    switch = NULL,
    drop = TRUE,
    dir = "h",
    strip.position = "top",
    page = 1
  )+ 
  ggtitle("Social Indicators in Low Income Countries"), height=400
)

```

*Analysis: Safe to say no relationships are observed for these sample countries*


## D- All Countries Scatterplots

Given the stronger observed relationships in Score Indexes Vs the traditional Social Indicators we will focus on showing the Income Group and Region ESG indexes' evolution.

We will study 10 year period progression from 1998 till 2018 of different combinations of the most impactful Indicators that show the highest relationships among them.

This is especially useful in studying patterns or linkages, not necessarily through time, between: Size of GDP, Region of a country and ESG scores.

### Environmental Performance Vs Economic Freedom 

Environmental and Economic Freedom (the proxy for Governmental Score)


```{r, echo=FALSE, out.width= "80%"}
ggplotly(ggplot(Complete.Table %>% filter( Year == 1998 | Year == 2008 | Year == 2018), 
                aes(x= EPI, y=EFI,group=Country))+
  geom_point(aes(color=Region,size=GDPpcap, shape = Income.Group))+
  facet_wrap( ~Year,  nrow = 1, ncol = 3)+
  ggtitle("EPI Vs EFI - 1998-2008-2018" ) +
  xlab("EPI")+
  ylab("EFI")+
  theme(legend.text = element_text(color = "grey", size = 5)), height = 400)
   
```

*Analysis: Region has an effect on score value but not necessarily score growth over time. Europe shows higher EFI and EPI scores and North America with East Asia have had growth in both these scores over time. We can also derive a clear observation that GDP per capita is positively related to EPI and EFI score.*


### Human Development Vs Economic Freedom 

Human Development (factor of Life Expectancy, Education and Income) and Economic Freedom (the proxy for Governmental Score)


```{r, echo=FALSE, out.width= "80%"}
ggplotly(ggplot(Complete.Table %>% filter( Year == 1998 | Year == 2008 | Year == 2018), aes(x= HDI, y=EFI,group=Country))+
  geom_point(aes(color=Region,size=GDPpcap, shape = Income.Group))+
  facet_wrap( ~Year,  nrow = 1, ncol = 3)+
  ggtitle("HDI Vs EFI - 1998-2008-2018" ) +
  xlab("HDI")+
  ylab("EFI")+
  theme(legend.text = element_text(color = "grey", size = 5)), height = 400)
   
```

*Analysis: Regional effects per period also clear. Higher Income regions and higher GDP per capita linked with a very High HDI score overall and medium to EFI score. We can also see middle income and mid level GDP per cap wth higher HDI scores compare to EFI and EPI for now. Increase in GDP size for Europe and America corresponds with rise in HDI.*

### Human Development Vs Environmental Performance 

Human Development (factor of Life Expectancy, Education and Income) and Environmental

```{r,echo=FALSE, out.width= "80%"}
ggplotly(ggplot(Complete.Table %>% filter( Year == 1998 | Year == 2008 | Year == 2018), aes(x= HDI, y=EPI,group=Country))+
  geom_point(aes(color=Region,size=GDPpcap, shape = Income.Group))+
  facet_wrap( ~Year,  nrow = 1, ncol = 3)+
  ggtitle("HDI Vs EPI - 1998-2008-2018" ) +
  xlab("HDI")+
  ylab("EPI")+
  theme(legend.text = element_text(color = "grey", size = 5)), height = 400)
   
```

*Analysis: EPI competes better with HDI in comparison to EFI, showing a stronger link between these 2 scoring indexes. Again , Region especially Upper middle to High Income one with bigger GDP per capita associate with not just higher HDI and EPI scores , but also an increase of both over time. As we can see the scatters are pushing to the upper right corner over time.*


## E- The ESG composite Vs GDP

Plotting the Time series of our own ESG Index Vs GDP per Capita to visually observe the bottom line relationship between these 2 indicators.

We were able to plot the variables using a Y axis Plot with adjustable axis. This allows a better scaled version visual of our study without having to manipulate, rebase or rescale the figures.

**United States**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "United States") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```


**Switzerland**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "Switzerland") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```


**India**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "India") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```

**South Africa**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "South Africa") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```

**China**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "South Africa") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```

**Tunisia**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "South Africa") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```

**Haiti**

```{r, echo=FALSE}
Rep.Countries %>% filter(Country == "South Africa") %>%
 plot_ly(x = ~Year, y = ~GDPpcap ,type = "scatter", mode = "lines", width = 600
        ,name = "GDP", height = 300) %>%
  add_trace(x = ~Year, y = ~ESGcomp, yaxis = "y2", name = "ESG") %>%  layout(
    yaxis = list(showline = FALSE, side = "right" ,title = "", color = "blue") ,
  yaxis2 = list( showline = FALSE,overlaying = "y" ,title = "", anchor = "free" , color = "orange" )
     ,xaxis = list( showline = FALSE, zeroline = FALSE, dtick = 0, title = "Year")
    ,showlegend = TRUE ,margin = list(pad = 30, b = 30, l = 150, r = 30)
    ,legend = list(orientation = "bottomright"), title = "ESG vs GDP")

```

We did the same visual analysis on all other countries but only showed the sample studied in the representative countries quantitative analysis and we got the below results...

*Analysis for the Time Series of Different Representative Countries:*

- *The Higher the Income Group leve the more stable and apparent the relationship*
- *Trend correlation are observed among most countries, regions and income groups*
- *Smaller economies, and lower income levels show more variability in the ESG and some deviations in the trendline over GDP per capita*


## F- Conclusive Answers to Research Questions

1. **Are Social, environmental and governmental indexes correlated?**

There is a clear visual and statistical correlation between the ESG Indexes and a clear trend is well observed over the years accross regions and countries. However, not all ESG score indexes have the same relationships. We saw a significant link between HDI factors: Life expectancy and Income also Education. It also seemed that Environmental Performance correlates better than Economic Freedom with the rest of the indexes. 

2. **Are these above links correlated/linked to Economic indicators?**

In a short answer: "YES". But diving in deeper, we saw that the higher the GDP per Capita, which was our Chosen main indicator, the more the ESG indexes relate to it over time. Our ESG composite had correlated trend over time for most observed countries. We however dropped FDI indicators form our study for being too volatile and showing no signs of relationship and noticed that GDP growth is quantitatively not a good Economic Benchmark. 


3. **Are there differences in relationships between different countries? Does Income Level affect the socio-economic relationships? Does a country's Region affect the socio-economic relationships ?** 

Yes, different countries show different strength and weaknesses in relationships but not an overall different statistical relationship.

Income Level had a direct impact on relationships. Obviously associated with GDP per capita, Income groups of higher level not only showed stronger ESG composite correlations but also significant statistical relationships with our Scoring ESG Indexes especially the ones that already correlated together better as mentioned in point 1. 
Higher income level associates with higher overall scores for ESG Indexes. the relationship was observed both quantitatively with the AIC approach in regression and Visually.  

Region by itself does not seem to impact the scores or present any value to the relationships. However, and for obvious reasons we did notice that the developed regions with Higher Income levels and GDP per capita such as EUrope, North America and East Asia do show stronger ESG and ESG Vs GDP relationships.

4. **Are traditional social indicators related with to ESG indexes or with Economic Indicators?**

Traditional Social indicators showed statistically way less correlation and relationship links with GDP compared to the ESG scores. Also lower correlations among themselves. They were less affected by Income Group Level and regions, showing mixed signs of links for different GDP per capita countries and different regions.
We did notice Urbanisation and Female Labour having some sort of correlation with our ESG composite however but could not conclude a clear unidirectional relationship over the representative countries.
